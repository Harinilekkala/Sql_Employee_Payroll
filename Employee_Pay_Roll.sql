--UC-1
create database PayRoll_Service
use PayRoll_Service

--UC-2
CREATE TABLE Employee_Payroll(
ID INT IDENTITY(1,1) PRIMARY KEY NOT NULL,
NAME VARCHAR(20) NOT NULL,
SALARY FLOAT NOT NUll,
START_DATE DATE NOT NULL
)

--UC-3
INSERT INTO Employee_Payroll VALUES('Harini',15000,'2022-06-19')
INSERT INTO Employee_Payroll VALUES('Harshini',25000,'2022-06-01')
INSERT INTO Employee_Payroll VALUES('Pardhavi',20000,'2018-02-25')
INSERT INTO Employee_Payroll VALUES('SENTHIL',25000,'2021-01-01')
INSERT INTO Employee_Payroll VALUES('PRIYA',10000,'2018-01-01')
INSERT INTO Employee_Payroll VALUES('RAMYA',40000,'2019-01-01')
INSERT INTO Employee_Payroll VALUES('LALITHA',30000,'2020-01-01')

--UC-4
SELECT * FROM Employee_Payroll

--UC-5
SELECT NAME,SALARY FROM Employee_Payroll WHERE NAME='Harini'
SELECT * FROM Employee_Payroll WHERE START_DATE BETWEEN '2021-06-01' AND CURRENT_TIMESTAMP

--UC-6
--ALTER TABLE employ_PayRoll ADD gender CHAR(10) CHECK (Gender IN ('M','F'));
ALTER TABLE Employee_Payroll ADD GENDER VARCHAR(10) NULL
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'Harini'
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'Harshini'
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'PRIYA'
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'Senthil'
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'RAMYA'
UPDATE EMPLOYEE_PAYROLL SET GENDER = 'F' WHERE NAME = 'LALITHA'

--UC7:
SELECT GENDER, SUM(SALARY) AS SUM_SALARY FROM EMPLOYEE_PAYROLL GROUP BY GENDER
SELECT GENDER, MIN(SALARY) AS MIN_SALARY FROM EMPLOYEE_PAYROLL GROUP BY GENDER
SELECT GENDER, MAX(SALARY) AS MAX_SALARY FROM EMPLOYEE_PAYROLL GROUP BY GENDER
SELECT GENDER, AVG(SALARY) AS AVG_SALARY FROM EMPLOYEE_PAYROLL GROUP BY GENDER
SELECT GENDER, COUNT(GENDER) AS EMPLOYEE_COUNT FROM EMPLOYEE_PAYROLL GROUP BY GENDER

--UC8:
ALTER TABLE EMPLOYEE_PAYROLL ADD MOBILE DECIMAL NOT NULL DEFAULT(0)
UPDATE EMPLOYEE_PAYROLL SET MOBILE = 123 WHERE NAME = 'Harini'
UPDATE EMPLOYEE_PAYROLL SET MOBILE = 456 WHERE NAME = 'Harshini'
UPDATE EMPLOYEE_PAYROLL SET MOBILE = 789 WHERE NAME = 'PRIYA'
UPDATE EMPLOYEE_PAYROLL SET MOBILE = 1011 WHERE NAME = 'LALITHA'
ALTER TABLE EMPLOYEE_PAYROLL ADD ADDRESS VARCHAR(100) NOT NULL DEFAULT(''), DEPARTMENT VARCHAR(50) NOT NULL DEFAULT('')
UPDATE EMPLOYEE_PAYROLL SET ADDRESS = 'A',DEPARTMENT = 'Production' WHERE NAME = 'Harini'
UPDATE EMPLOYEE_PAYROLL SET ADDRESS = 'B',DEPARTMENT = 'Administration' WHERE NAME = 'Harshini'
UPDATE EMPLOYEE_PAYROLL SET ADDRESS = 'C',DEPARTMENT = 'IT_Support' WHERE NAME = 'PRIYA'
UPDATE EMPLOYEE_PAYROLL SET ADDRESS = 'D',DEPARTMENT = 'Production' WHERE NAME = 'LALITHA'

--UC9:
ALTER TABLE EMPLOYEE_PAYROLL ADD BASIC_PAY FLOAT NOT NULL DEFAULT(0), DEDUCTIONS FLOAT NOT NULL DEFAULT(0),
TAXABLE_PAY FLOAT NOT NULL DEFAULT(0), NET_PAY FLOAT NOT NULL DEFAULT(0)
UPDATE EMPLOYEE_PAYROLL SET BASIC_PAY = 10000,DEDUCTIONS = 200,TAXABLE_PAY = 200,NET_PAY = 9600 WHERE ID = 1
UPDATE EMPLOYEE_PAYROLL SET BASIC_PAY = 10000,DEDUCTIONS = 200,TAXABLE_PAY = 200,NET_PAY = 9600 WHERE ID = 2
UPDATE EMPLOYEE_PAYROLL SET BASIC_PAY = 15000,DEDUCTIONS = 200,TAXABLE_PAY = 200,NET_PAY = 14600 WHERE ID = 3
UPDATE EMPLOYEE_PAYROLL SET BASIC_PAY = 20000,DEDUCTIONS = 200,TAXABLE_PAY = 200,NET_PAY = 19600 WHERE ID = 4

--UC10:
INSERT INTO EMPLOYEE_PAYROLL VALUES('Terisa',15000,'2021-01-01','F',9876543210,'Chennai','Sales&Marketing',15000,200,200,14600)
UPDATE EMPLOYEE_PAYROLL SET NAME = 'Harshini' WHERE ID = 5

Select * from Employee_Payroll

--UC-11
--FOR UC-10- ER DIAGRAM CREATED FOR BELOW TABLES

CREATE TABLE COMPANY_DETAILS(
COMPANY_NAME VARCHAR(30) PRIMARY KEY NOT NULL,
COMPANY_ID INT ,
)

SELECT * FROM COMPANY_DETAILS

INSERT INTO COMPANY_DETAILS VALUES ('ABC Company', 101)
INSERT INTO COMPANY_DETAILS VALUES ('XYZ Company', 102)

CREATE TABLE PAYROLL_DETAILS(
EMPLOYEE_ID INT PRIMARY KEY NOT NULL,
BASIC_PAY INT,
DEDUCTIONS INT,
TAXABLE_PAY INT,
INCOMETAX INT,
NET_PAY INT
) 

SELECT * FROM PAYROLL_DETAILS

INSERT INTO PAYROLL_DETAILS VALUES (1,25000,500,200,300,24000)
INSERT INTO PAYROLL_DETAILS VALUES (2,25000,500,200,300,24000)
INSERT INTO PAYROLL_DETAILS VALUES (3,30000,1000,200,300,28500)
INSERT INTO PAYROLL_DETAILS VALUES (4,30000,1000,200,300,28500)
INSERT INTO PAYROLL_DETAILS VALUES (5,35000,1000,200,300,33500)

CREATE TABLE DEPARTMENT_DETAILS(
DEPARTMENT_ID VARCHAR(10) PRIMARY KEY NOT NULL,
DEPARTMENT_NAME VARCHAR(25)
)

SELECT * FROM DEPARTMENT_DETAILS

INSERT INTO DEPARTMENT_DETAILS VALUES ('01D','DEVELOPER')
INSERT INTO DEPARTMENT_DETAILS VALUES ('01S','SALES')
INSERT INTO DEPARTMENT_DETAILS VALUES ('01M','MARKETING')

CREATE TABLE EMPLOYEE_DEPARTMENT(
EMPLOYEE_ID INT  NOT NULL, 
EMPLOYEE_NAME VARCHAR(25),
DEPARTMENT_ID VARCHAR(10) NOT NULL,
DEPARTMENT_NAME VARCHAR(25)
)

SELECT * FROM EMPLOYEE_DEPARTMENT

INSERT INTO EMPLOYEE_DEPARTMENT VALUES (1,'Harini','01D','DEVELOPER')
INSERT INTO EMPLOYEE_DEPARTMENT VALUES (2,'Harshini','01D','DEVELOPER')
INSERT INTO EMPLOYEE_DEPARTMENT VALUES (3,'RAMYA','01S','SALES')
INSERT INTO EMPLOYEE_DEPARTMENT VALUES (4,'PRIYA','01M','MARKETING')
INSERT INTO EMPLOYEE_DEPARTMENT VALUES (5,'TERISSA','01M','MARKETING')
INSERT INTO EMPLOYEE_DEPARTMENT VALUES (5,'TERISSA','01S','SALES')

CREATE TABLE EMPLOYEE_DETAIL(
EMPLOYEE_ID INT IDENTITY(1,1) PRIMARY KEY NOT NULL, 
EMPLOYEE_NAME VARCHAR(25),
GENDER VARCHAR(2),
ADDRESS VARCHAR(50),
PHONE_NUMBER FLOAT,
EMAIL VARCHAR(30)
)

ALTER TABLE EMPLOYEE_DETAIL ADD COMPANY_NAME VARCHAR(20)
ALTER TABLE EMPLOYEE_DETAIL ALTER COLUMN COMPANY_NAME VARCHAR(30)
ALTER TABLE EMPLOYEE_DETAIL ADD JOINING_DATA DATE

SELECT * FROM EMPLOYEE_DETAIL

INSERT INTO EMPLOYEE_DETAIL VALUES (1,'HARINI','F','Harini ADDRESS',9874561230,'harini@gmail.com','ABC Company')
INSERT INTO EMPLOYEE_DETAIL VALUES (2,'Harshini','M','Harshini ADDRESS',7894561230,'harshini@gmail.com','ABC Company')
INSERT INTO EMPLOYEE_DETAIL VALUES (3,'RAMYA','F','RAMYA ADDRESS',8956231470,'ramya@gmail.com','ABC Company')
INSERT INTO EMPLOYEE_DETAIL VALUES (4,'PRIYA','F','PRIYA ADDRESS',9756324895,'priya@gmail.com','ABC Company')
INSERT INTO EMPLOYEE_DETAIL VALUES (5,'TERISSA','F','TERISSA ADDRESS',8855226699,'terssia@gmail.com','ABC Company')

UPDATE EMPLOYEE_DETAIL SET JOINING_DATA = '2022-01-05' WHERE EMPLOYEE_ID = 1 
UPDATE EMPLOYEE_DETAIL SET JOINING_DATA = '2018-05-10' WHERE EMPLOYEE_ID = 2
UPDATE EMPLOYEE_DETAIL SET JOINING_DATA = '2021-12-11' WHERE EMPLOYEE_ID = 3 
UPDATE EMPLOYEE_DETAIL SET JOINING_DATA = '2020-04-10' WHERE EMPLOYEE_ID = 4 
UPDATE EMPLOYEE_DETAIL SET JOINING_DATA = '2022-02-14' WHERE EMPLOYEE_ID = 5 

--DELETE FROM EMPLOYEE_DETAIL WHERE EMPLOYEE_NAME = 'TERSSIA'
--UPDATE EMPLOYEE_DETAIL SET EMPLOYEE_NAME = 'TERISSA' WHERE EMPLOYEE_NAME = 'TERSSIA'
--UPDATE EMPLOYEE_DETAIL SET EMPLOYEE_ID = 5 WHERE EMPLOYEE_ID = 6

SELECT * FROM EMPLOYEE_DETAIL

ALTER TABLE EMPLOYEE_DETAIL ADD CONSTRAINT FOREIGN_KEY FOREIGN KEY(COMPANY_NAME) REFERENCES COMPANY_DETAILS(COMPANY_NAME) 
ALTER TABLE EMPLOYEE_DEPARTMENT ADD CONSTRAINT FOREIGN_KEY1 FOREIGN KEY(DEPARTMENT_ID) REFERENCES DEPARTMENT_DETAILS(DEPARTMENT_ID)
ALTER TABLE EMPLOYEE_DEPARTMENT ADD CONSTRAINT FOREIGN_KEY2 FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEE_DETAIL(EMPLOYEE_ID)
ALTER TABLE PAYROLL_DETAILS ADD CONSTRAINT FOREIGN_KEY3 FOREIGN KEY(EMPLOYEE_ID) REFERENCES EMPLOYEE_DETAIL(EMPLOYEE_ID)

SELECT GENDER, SUM(BASIC_PAY) AS TOTAL_SALARY FROM EMPLOYEE_DETAIL AS ED INNER JOIN PAYROLL_DETAILS AS PD ON ED.EMPLOYEE_ID = PD.EMPLOYEE_ID GROUP BY GENDER
SELECT GENDER, AVG(BASIC_PAY) AS AVERAGE_SALART FROM EMPLOYEE_DETAIL AS ED INNER JOIN PAYROLL_DETAILS AS PD ON ED.EMPLOYEE_ID = PD.EMPLOYEE_ID GROUP BY GENDER
SELECT GENDER, MIN(BASIC_PAY) AS MINIMUM_SALARY FROM EMPLOYEE_DETAIL AS ED INNER JOIN PAYROLL_DETAILS PD ON ED.EMPLOYEE_ID = PD.EMPLOYEE_ID GROUP BY GENDER
SELECT GENDER, MAX(BASIC_PAY) AS MAX_SALARY FROM EMPLOYEE_DETAIL AS ED INNER JOIN PAYROLL_DETAILS AS PD ON ED.EMPLOYEE_ID = PD.EMPLOYEE_ID GROUP BY GENDER
SELECT GENDER, COUNT(GENDER) FROM EMPLOYEE_DETAIL GROUP BY GENDER

--UC-12

SELECT EMPLOYEE_NAME FROM EMPLOYEE_DETAIL WHERE JOINING_DATA BETWEEN '2020-04-10' AND CURRENT_TIMESTAMP
SELECT COMPANY.COMPANY_NAME,COMPANY.COMPANY_ID,EMP.EMPLOYEE_ID,EMP.EMPLOYEE_NAME,EMP.GENDER,EMP.ADDRESS,EMP.PHONE_NUMBER,EMP.EMAIL,EMP.JOINING_DATA,DEPT.DEPARTMENT_ID,DEPT.DEPARTMENT_NAME,SALARY.BASIC_PAY,SALARY.NET_PAY
FROM COMPANY_DETAILS COMPANY INNER JOIN EMPLOYEE_DETAIL EMP ON COMPANY.COMPANY_NAME = EMP.COMPANY_NAME INNER JOIN EMPLOYEE_DEPARTMENT DEPT ON DEPT.EMPLOYEE_ID = EMP.EMPLOYEE_ID INNER JOIN PAYROLL_DETAILS SALARY ON SALARY.EMPLOYEE_ID = EMP.EMPLOYEE_ID


